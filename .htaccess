RewriteEngine On

# Linie routing: /linie/XXX-YY.php -> linie/index.php (dynamic handler)
RewriteCond %{REQUEST_URI} ^/linie/[^/]+\.php$ [NC]
RewriteRule ^linie/(.+)\.php$ /linie/index.php [L,QSA]

# Redirect linie .html to .php
RewriteCond %{REQUEST_URI} ^/linie/(.+)\.html$ [NC]
RewriteRule ^linie/(.+)\.html$ /linie/$1.php [R=301,L]

# Jeśli żądanie kończy się na .html i istnieje odpowiadający .php, przekieruj 301 na .php
RewriteCond %{REQUEST_URI} ^/(.*)\.html$ [NC]
RewriteCond %{DOCUMENT_ROOT}/%1.php -f
RewriteRule ^(.*)\.html$ /$1.php [R=301,L]

# mapowanie ładnych ścieżek OAuth do plików PHP
RewriteRule ^auth/discord/?$ /auth/discord.php [L,QSA]
RewriteRule ^auth/discord/callback/?$ /auth/discord_callback.php [L,QSA]

# API -> panel/api.php
RewriteRule ^api/(.*)$ /panel/api.php [L,QSA]
